SingleShotMaskDetector(
  (encoder): MoConv(
    (conv_1): Conv2d(3, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False, normalization=SyncBatchNorm, activation=Swish)
    (layer_1): Sequential(
      (0): InvertedResidual(in_channels=16, out_channels=32, stride=1, exp=6, dilation=1, skip_conn=False)
    )
    (layer_2): Sequential(
      (0): InvertedResidual(in_channels=32, out_channels=64, stride=2, exp=6, dilation=1, skip_conn=False)
      (1): InvertedResidual(in_channels=64, out_channels=64, stride=1, exp=6, dilation=1, skip_conn=True)
      (2): InvertedResidual(in_channels=64, out_channels=64, stride=1, exp=6, dilation=1, skip_conn=True)
    )
    (layer_3): Sequential(
      (0): InvertedResidual(in_channels=64, out_channels=128, stride=2, exp=6, dilation=1, skip_conn=False)
      (1): MoConvBlock
      (2): MoConvBlock
      (3): LayerNorm()
    )
    (layer_4): Sequential(
      (0): InvertedResidual(in_channels=128, out_channels=192, stride=2, exp=6, dilation=1, skip_conn=False)
      (1): MoConvBlock
      (2): MoConvBlock
      (3): MoConvBlock
      (4): MoConvBlock
      (5): LayerNorm()
    )
    (layer_5): Sequential(
      (0): InvertedResidual(in_channels=192, out_channels=256, stride=2, exp=6, dilation=1, skip_conn=False)
      (1): MoConvBlock
      (2): MoConvBlock
      (3): MoConvBlock
      (4): LayerNorm()
    )
    (conv_1x1_exp): None
    (classifier): None
  )
  (extra_layers): ModuleDict(
    (os_64): SeparableConv2d(in_channels=256, out_channels=256, kernel_size=3, stride=2, dilation=1)
    (os_128): SeparableConv2d(in_channels=256, out_channels=128, kernel_size=3, stride=2, dilation=1)
    (os_256): SeparableConv2d(in_channels=128, out_channels=128, kernel_size=3, stride=2, dilation=1)
    (os_-1): Sequential(
      (0): AdaptiveAvgPool2d(output_size=1)
      (1): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, activation=ReLU)
    )
  )
  (anchor_box_generator): SSDAnchorGenerator(min_scale_ratio=0.1, max_scale_ratio=1.05, n_output_strides=6, n_aspect_ratios=6, clipping=True)
  (ssd_heads): ModuleList(
    (0): SSDHead(in_channels=512, n_anchors=6, n_classes=81, n_coordinates=4, kernel_size=3, stride=1, proj=True, proj_channels=512)
    (1-2): 2 x SSDHead(in_channels=256, n_anchors=6, n_classes=81, n_coordinates=4, kernel_size=3, stride=1)
    (3-4): 2 x SSDHead(in_channels=128, n_anchors=6, n_classes=81, n_coordinates=4, kernel_size=3, stride=1)
    (5): SSDHead(in_channels=64, n_anchors=4, n_classes=81, n_coordinates=4, kernel_size=1, stride=1)
  )
)
=================================================================
             SingleShotMaskDetector Summary
=================================================================
Overall parameters   =    5.404 M
2024-11-12 21:32:03 - LOGS    - FVCore Analysis:
2024-11-12 21:32:03 - LOGS    - Input sizes: [1, 3, 320, 320]
| module                                          | #parameters or shape   | #flops     |
|:------------------------------------------------|:-----------------------|:-----------|
| model                                           | 5.404M                 | 3.138G     |
|  encoder                                        |  4.482M                |  2.972G    |
|   encoder.conv_1.block                          |   0.464K               |   11.878M  |
|    encoder.conv_1.block.conv                    |    0.432K              |    11.059M |
|    encoder.conv_1.block.norm                    |    32                  |    0.819M  |
|   encoder.layer_1.0.block                       |   5.92K                |   0.152G   |
|    encoder.layer_1.0.block.exp_1x1.block        |    1.728K              |    44.237M |
|    encoder.layer_1.0.block.conv_3x3.block       |    1.056K              |    27.034M |
|    encoder.layer_1.0.block.red_1x1.block        |    3.136K              |    80.282M |
|   encoder.layer_2                               |   0.13M                |   0.955G   |
|    encoder.layer_2.0.block                      |    21.056K             |    0.26G   |
|    encoder.layer_2.1.block                      |    54.272K             |    0.347G  |
|    encoder.layer_2.2.block                      |    54.272K             |    0.347G  |
|   encoder.layer_3                               |   0.392M               |   0.757G   |
|    encoder.layer_3.0.block                      |    78.976K             |    0.248G  |
|    encoder.layer_3.1                            |    0.156M              |    0.254G  |
|    encoder.layer_3.2                            |    0.156M              |    0.254G  |
|    encoder.layer_3.3                            |    0.256K              |    0       |
|   encoder.layer_4                               |   1.624M               |   0.778G   |
|    encoder.layer_4.0.block                      |    0.256M              |    0.222G  |
|    encoder.layer_4.1                            |    0.342M              |    0.139G  |
|    encoder.layer_4.2                            |    0.342M              |    0.139G  |
|    encoder.layer_4.3                            |    0.342M              |    0.139G  |
|    encoder.layer_4.4                            |    0.342M              |    0.139G  |
|    encoder.layer_4.5                            |    0.384K              |    0       |
|   encoder.layer_5                               |   2.33M                |   0.319G   |
|    encoder.layer_5.0.block                      |    0.532M              |    0.12G   |
|    encoder.layer_5.1                            |    0.599M              |    66.158M |
|    encoder.layer_5.2                            |    0.599M              |    66.158M |
|    encoder.layer_5.3                            |    0.599M              |    66.158M |
|    encoder.layer_5.4                            |    0.512K              |    0       |
|  extra_layers                                   |  0.131M                |  2.125M    |
|   extra_layers.os_64                            |   68.864K              |   1.722M   |
|    extra_layers.os_64.dw_conv.block             |    2.816K              |    70.4K   |
|    extra_layers.os_64.pw_conv.block             |    66.048K             |    1.651M  |
|   extra_layers.os_128                           |   35.84K               |   0.323M   |
|    extra_layers.os_128.dw_conv.block            |    2.816K              |    25.344K |
|    extra_layers.os_128.pw_conv.block            |    33.024K             |    0.297M  |
|   extra_layers.os_256                           |   18.048K              |   72.192K  |
|    extra_layers.os_256.dw_conv.block            |    1.408K              |    5.632K  |
|    extra_layers.os_256.pw_conv.block            |    16.64K              |    66.56K  |
|   extra_layers.os_-1                            |   8.192K               |   8.704K   |
|    extra_layers.os_-1.1.block.conv              |    8.192K              |    8.192K  |
|    extra_layers.os_-1.0                         |                        |    0.512K  |
|  ssd_heads                                      |  0.791M                |  0.164G    |
|   ssd_heads.0                                   |   0.367M               |   0.146G   |
|    ssd_heads.0.proj_layer.block                 |    99.328K             |    39.731M |
|    ssd_heads.0.loc_cls_layer                    |    0.267M              |    0.107G  |
|   ssd_heads.1.loc_cls_layer                     |   0.134M               |   13.338M  |
|    ssd_heads.1.loc_cls_layer.dw_conv.block      |    2.816K              |    0.282M  |
|    ssd_heads.1.loc_cls_layer.pw_conv.block.conv |    0.131M              |    13.056M |
|   ssd_heads.2.loc_cls_layer                     |   0.134M               |   3.334M   |
|    ssd_heads.2.loc_cls_layer.dw_conv.block      |    2.816K              |    70.4K   |
|    ssd_heads.2.loc_cls_layer.pw_conv.block.conv |    0.131M              |    3.264M  |
|   ssd_heads.3.loc_cls_layer                     |   67.198K              |   0.6M     |
|    ssd_heads.3.loc_cls_layer.dw_conv.block      |    1.408K              |    12.672K |
|    ssd_heads.3.loc_cls_layer.pw_conv.block.conv |    65.79K              |    0.588M  |
|   ssd_heads.4.loc_cls_layer                     |   67.198K              |   0.267M   |
|    ssd_heads.4.loc_cls_layer.dw_conv.block      |    1.408K              |    5.632K  |
|    ssd_heads.4.loc_cls_layer.pw_conv.block.conv |    65.79K              |    0.261M  |
|   ssd_heads.5.loc_cls_layer.block.conv          |   22.1K                |   21.76K   |
|    ssd_heads.5.loc_cls_layer.block.conv.weight  |    (340, 64, 1, 1)     |            |
|    ssd_heads.5.loc_cls_layer.block.conv.bias    |    (340,)    
